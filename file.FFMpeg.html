<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: FFMpeg
  
    &mdash; Hornetseye - Ruby-extension for Computer Vision (DEPRECATED)
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "FFMpeg";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: FFMpeg</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-Reading+and+Writing+Video+Files">Reading and Writing Video Files</h1>

<p><img src="images/sintel.jpg"></p>

<h2 id="label-Read+Video+Data">Read Video Data</h2>

<p>The class <span class='object_link'><a href="Hornetseye/AVInput.html" title="Hornetseye::AVInput (class)">Hornetseye::AVInput</a></span> allows you to capture frames from videos using the <a href="http://www.ffmpeg.org/">FFMpeg library</a>. The example program shows how to display a video.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_ffmpeg</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_xorg</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="Hornetseye.html" title="Hornetseye (module)">Hornetseye</a></span></span>
<span class='id identifier rubyid_input'>input</span> <span class='op'>=</span> <span class='const'>AVInput</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://peach.themazzone.com/durian/movies/sintel-1024-surround.mp4</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_width'>width</span> <span class='op'>*</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_aspect_ratio'>aspect_ratio</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_height'>height</span>
<span class='const'>X11Display</span><span class='period'>.</span><span class='id identifier rubyid_show'>show</span><span class='lparen'>(</span><span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='symbol'>:frame_rate</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_frame_rate'>frame_rate</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='rbrace'>}</span>
</code></pre>

<p><img src="images/ardrone.jpg"></p>

<p>Using FFMpeg it is also possible to decode H.264 live streams. Here is an example to read and display the video stream from a <a href="http://ardrone2.parrot.com/">Parrot AR.Drone 2.0</a> with a small Ruby program.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_ffmpeg</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_xorg</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="Hornetseye.html" title="Hornetseye (module)">Hornetseye</a></span></span>
<span class='id identifier rubyid_input'>input</span> <span class='op'>=</span> <span class='const'>AVInput</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tcp://192.168.1.1:5555</span><span class='tstring_end'>&#39;</span></span>
<span class='const'>X11Display</span><span class='period'>.</span><span class='id identifier rubyid_show'>show</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='rbrace'>}</span>
</code></pre>

<h2 id="label-Read+Audio+Data">Read Audio Data</h2>

<p>The following example reads data from an audio file. The data is written to the audio output device. Note that currently one has to catch the exception occurring at the end of the stream.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_ffmpeg</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_alsa</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="Hornetseye.html" title="Hornetseye (module)">Hornetseye</a></span></span>
<span class='id identifier rubyid_input'>input</span> <span class='op'>=</span> <span class='const'>AVInput</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://www.kozco.com/tech/LRMonoPhaset4.wav</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_alsa'>alsa</span> <span class='op'>=</span> <span class='const'>AlsaOutput</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>default</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_sample_rate'>sample_rate</span><span class='comma'>,</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_channels'>channels</span>
<span class='kw'>begin</span>
  <span class='kw'>while</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_alsa'>alsa</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>RuntimeError</span>
<span class='kw'>end</span>
</code></pre>

<h2 id="label-Read+Video+and+Audio+Data">Read Video and Audio Data</h2>

<p>It is also possible to retrieve audio frames if the video file offers an audio stream. The audio frames are two-dimensional arrays with the first dimension indicating the number of audio channels (<em>i.e.</em> 1=mono, 2=stereo). The following example plays synchronised video and audio.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_ffmpeg</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_xorg</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_alsa</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="Hornetseye.html" title="Hornetseye (module)">Hornetseye</a></span></span>
<span class='id identifier rubyid_input'>input</span> <span class='op'>=</span> <span class='const'>AVInput</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://peach.themazzone.com/durian/movies/sintel-1024-surround.mp4</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_width'>width</span> <span class='op'>*</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_aspect_ratio'>aspect_ratio</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_height'>height</span>
<span class='id identifier rubyid_alsa'>alsa</span> <span class='op'>=</span> <span class='const'>AlsaOutput</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>default</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_sample_rate'>sample_rate</span><span class='comma'>,</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_channels'>channels</span>
<span class='id identifier rubyid_audio_frame'>audio_frame</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_read_audio'>read_audio</span>
<span class='const'>X11Display</span><span class='period'>.</span><span class='id identifier rubyid_show'>show</span> <span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='symbol'>:title</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FFMpeg</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:output</span> <span class='op'>=&gt;</span> <span class='const'>XVideoOutput</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_display'>display</span><span class='op'>|</span>
  <span class='id identifier rubyid_video_frame'>video_frame</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_read_video'>read_video</span>
  <span class='kw'>while</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_audio_pos'>audio_pos</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_video_pos'>video_pos</span> <span class='op'>+</span> <span class='float'>0.2</span>
    <span class='id identifier rubyid_alsa'>alsa</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_audio_frame'>audio_frame</span>
    <span class='id identifier rubyid_audio_frame'>audio_frame</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_read_audio'>read_audio</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_audio_pos'>audio_pos</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='id identifier rubyid_alsa'>alsa</span><span class='period'>.</span><span class='id identifier rubyid_delay'>delay</span> <span class='op'>+</span> <span class='id identifier rubyid_audio_frame'>audio_frame</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_quo'>quo</span><span class='lparen'>(</span> <span class='id identifier rubyid_alsa'>alsa</span><span class='period'>.</span><span class='id identifier rubyid_rate'>rate</span> <span class='rparen'>)</span>
  <span class='id identifier rubyid_display'>display</span><span class='period'>.</span><span class='id identifier rubyid_event_loop'>event_loop</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_video_pos'>video_pos</span> <span class='op'>-</span> <span class='id identifier rubyid_t'>t</span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
  <span class='id identifier rubyid_video_frame'>video_frame</span>
<span class='kw'>end</span>
</code></pre>

<h2 id="label-Record+Video+and+Audio">Record Video and Audio</h2>

<p>This example is about recording audio and video in real-time. The frame rate needs to be specified ahead of time. It might be necessary to reduce the value if the camera or the computer are too slow.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_v4l2</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_alsa</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_xorg</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_ffmpeg</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="Hornetseye.html" title="Hornetseye (module)">Hornetseye</a></span></span>
<span class='const'>FRAME_RATE</span> <span class='op'>=</span> <span class='int'>8</span>
<span class='id identifier rubyid_camera'>camera</span> <span class='op'>=</span> <span class='const'>V4L2Input</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/dev/video0</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_modes'>modes</span><span class='op'>|</span>
  <span class='id identifier rubyid_modes'>modes</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_mode'>mode</span><span class='comma'>,</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_content'>. </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mode'>mode</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_modes'>modes</span><span class='lbracket'>[</span><span class='const'>STDIN</span><span class='period'>.</span><span class='id identifier rubyid_readline'>readline</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>-</span> <span class='int'>1</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> <span class='id identifier rubyid_camera'>camera</span><span class='period'>.</span><span class='id identifier rubyid_width'>width</span><span class='comma'>,</span> <span class='id identifier rubyid_camera'>camera</span><span class='period'>.</span><span class='id identifier rubyid_height'>height</span>
<span class='id identifier rubyid_audio'>audio</span> <span class='op'>=</span> <span class='const'>AlsaInput</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>default</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='const'>AVOutput</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test.avi</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='int'>4000000</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='const'>FRAME_RATE</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='const'>AVOutput</span><span class='op'>::</span><span class='const'>CODEC_ID_MPEG4</span><span class='comma'>,</span>
  <span class='kw'>true</span><span class='comma'>,</span> <span class='int'>128000</span><span class='comma'>,</span> <span class='id identifier rubyid_audio'>audio</span><span class='period'>.</span><span class='id identifier rubyid_rate'>rate</span><span class='comma'>,</span> <span class='id identifier rubyid_audio'>audio</span><span class='period'>.</span><span class='id identifier rubyid_channels'>channels</span><span class='comma'>,</span> <span class='const'>AVOutput</span><span class='op'>::</span><span class='const'>CODEC_ID_MP3</span>
<span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
<span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='const'>X11Display</span><span class='period'>.</span><span class='id identifier rubyid_show'>show</span> <span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='symbol'>:title</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FFMpeg</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:output</span> <span class='op'>=&gt;</span> <span class='const'>XVideoOutput</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_img'>img</span> <span class='op'>=</span> <span class='id identifier rubyid_camera'>camera</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
  <span class='id identifier rubyid_output'>output</span><span class='period'>.</span><span class='id identifier rubyid_write_video'>write_video</span> <span class='id identifier rubyid_img'>img</span>
  <span class='id identifier rubyid_output'>output</span><span class='period'>.</span><span class='id identifier rubyid_write_audio'>write_audio</span> <span class='id identifier rubyid_audio'>audio</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_audio'>audio</span><span class='period'>.</span><span class='id identifier rubyid_rate'>rate</span> <span class='op'>/</span> <span class='const'>FRAME_RATE</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_c'>c</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_c'>c</span> <span class='op'>/</span> <span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>-</span> <span class='id identifier rubyid_t'>t</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_c'>c</span> <span class='op'>%</span> <span class='const'>FRAME_RATE</span> <span class='op'>==</span> <span class='int'>0</span>
  <span class='id identifier rubyid_img'>img</span>
<span class='kw'>end</span>
</code></pre>

<h2 id="label-Anaglyph+Videos">Anaglyph Videos</h2>

<p><img src="images/anaglyph.jpg"></p>

<p>One can download <a href="http://www.youtube.com/3d">3D stereo videos from Youtube</a> and convert them to a red-cyan <a href="http://en.wikipedia.org/wiki/Anaglyph_image">anaglyph</a> video as follows. To download videos from Youtube, one can can use the <a href="https://addons.mozilla.org/firefox/addon/unplug/">Unplug</a> add-on for Firefox.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_ffmpeg</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hornetseye_xorg</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="Hornetseye.html" title="Hornetseye (module)">Hornetseye</a></span></span>
<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Syntax: ./anaglyph [input] [output]</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='const'>ARGV</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>!=</span> <span class='int'>2</span>
<span class='id identifier rubyid_input'>input</span> <span class='op'>=</span> <span class='const'>AVInput</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'>ARGV</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
<span class='id identifier rubyid_w2'>w2</span><span class='comma'>,</span> <span class='id identifier rubyid_h2'>h2</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_width'>width</span><span class='comma'>,</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_height'>height</span>
<span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> <span class='id identifier rubyid_w2'>w2</span> <span class='op'>/</span> <span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_h2'>h2</span> <span class='comment'># h2 * 2 / 3
</span><span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='const'>AVOutput</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'>ARGV</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>4000000</span><span class='comma'>,</span> <span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_frame_rate'>frame_rate</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='int'>128000</span><span class='comma'>,</span>
                      <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_sample_rate'>sample_rate</span><span class='comma'>,</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_channels'>channels</span><span class='comma'>,</span> <span class='kw'>nil</span>
<span class='id identifier rubyid_y'>y</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_h2'>h2</span> <span class='op'>-</span> <span class='id identifier rubyid_h'>h</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='int'>2</span>
<span class='const'>X11Display</span><span class='period'>.</span><span class='id identifier rubyid_show'>show</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_img'>img</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_read_video'>read_video</span><span class='period'>.</span><span class='id identifier rubyid_to_ubytergb'>to_ubytergb</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_output'>output</span><span class='period'>.</span><span class='id identifier rubyid_write_audio'>write_audio</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_read_audio'>read_audio</span>
  <span class='kw'>end</span> <span class='kw'>while</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_audio_pos'>audio_pos</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_video_pos'>video_pos</span>
  <span class='id identifier rubyid_left'>left</span>  <span class='op'>=</span> <span class='id identifier rubyid_img'>img</span><span class='lbracket'>[</span><span class='int'>0</span> <span class='op'>...</span>  <span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span> <span class='op'>...</span> <span class='id identifier rubyid_y'>y</span> <span class='op'>+</span> <span class='id identifier rubyid_h'>h</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_right'>right</span> <span class='op'>=</span> <span class='id identifier rubyid_img'>img</span><span class='lbracket'>[</span><span class='id identifier rubyid_w'>w</span> <span class='op'>...</span> <span class='id identifier rubyid_w2'>w2</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span> <span class='op'>...</span> <span class='id identifier rubyid_y'>y</span> <span class='op'>+</span> <span class='id identifier rubyid_h'>h</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>MultiArray</span><span class='period'>.</span><span class='id identifier rubyid_ubytergb'>ubytergb</span> <span class='id identifier rubyid_w'>w</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span>
  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_g'>g</span><span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_left'>left</span><span class='period'>.</span><span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_right'>right</span><span class='period'>.</span><span class='id identifier rubyid_g'>g</span> <span class='op'>/</span> <span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_right'>right</span><span class='period'>.</span><span class='id identifier rubyid_b'>b</span> <span class='op'>/</span> <span class='int'>2</span>
  <span class='id identifier rubyid_output'>output</span><span class='period'>.</span><span class='id identifier rubyid_write_video'>write_video</span> <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span>
</code></pre>

<h2 id="label-See+also">See also</h2>
<ul><li>
<p><span class='object_link'><a href="Hornetseye/AVInput.html" title="Hornetseye::AVInput (class)">Hornetseye::AVInput</a></span></p>
</li><li>
<p><span class='object_link'><a href="Hornetseye/AVOutput.html" title="Hornetseye::AVOutput (class)">Hornetseye::AVOutput</a></span></p>
</li></ul>

<h2 id="label-External+Links">External Links</h2>
<ul><li>
<p><a href="http://www.ffmpeg.org/">FFMpeg audio/video codec library</a></p>
</li><li>
<p><a href="http://sintel.org/">Sintel, the Durian Open Movie Project</a></p>
</li><li>
<p><a href="http://www.youtube.com/3d">Youtube 3D</a></p>
</li><li>
<p><a href="http://en.wikipedia.org/wiki/Anaglyph_image">Anaglyph images</a></p>
</li><li>
<p><a href="https://addons.mozilla.org/firefox/addon/unplug/">Unplug (add-on for Firefox)</a></p>
</li></ul>
</div></div>

      <div id="footer">
  Generated on Mon Feb  3 19:23:56 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.4.1).
</div>

    </div>
  </body>
</html>